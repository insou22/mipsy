<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8" />
    <title>mipsy</title>
    <link href="tailwind.css" rel="stylesheet" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />

    <!-- split.js for the drag and drop areas -->
    <script src="https://unpkg.com/split.js/dist/split.min.js"></script>
    <script>
        function split_setup() {
          console.log("setting up splits...");
          Split(["#file_data", "#information"], {
            sizes: [70, 30],
          });          
          Split(["#regs", "#output"], {
            direction: "vertical",
          });
        };

        function alarm() {
            console.error("AHHHHHHHHHHH");
        };
    </script>

    <!-- Monaco for the code editor -->
    <link rel="stylesheet" data-name="vs/editor/editor.main" href="package/min/vs/editor/editor.main.css">
    <script>var require = { paths: { 'vs': 'package/min/vs' } };</script>
    <script src="package/min/vs/loader.js"></script>
    <script src="package/min/vs/editor/editor.main.nls.js"></script>
    <script src="package/min/vs/editor/editor.main.js"></script>

    <script>
      function init_editor() {
        var h_div = document.getElementById("monaco_editor");
        var editor = monaco.editor.create(h_div, {
          value: "",
          language: "mips",
          automaticLayout: true,
          scrollBeyondLastLine: false,
          minimap: {
            enabled: false,
          },
        });

        window.editor = editor;
      }
    
      function highlight_section(startLineNumber, startColumn, endColumn) {
        if (window.editor === undefined || window.editor === null) {
          return;
        };

        let range = new monaco.Range(startLineNumber, startColumn, startLineNumber, endColumn);
        window.editor.deltaDecorations(
          [],
          [
            {
              range,
              options: {
                inlineClassName: "highlight-line-err",
              },
            },
            {
              range,
              options: {
                linesDecorationsClassName: "highlight-line-gutter",
                isWholeLine: true,
              },
            }
          ]
        );
      }

      function set_editor_value(value="") {
        window.editor.setValue(value);
      }

      function get_editor_value() {
        return window.editor.getValue();
      }

      function trigger_download_file(filename, text) {
        var element = document.createElement('a');
        element.setAttribute('href', 'data:text/plain;charset=utf-8,' + encodeURIComponent(text));
        element.setAttribute('download', filename);

        element.style.display = 'none';
        document.body.appendChild(element);

        element.click();

        document.body.removeChild(element);
      }

    </script>
    <script src="wasm.js"></script>
    <script type="application/javascript">wasm_bindgen('wasm_bg.wasm');</script>

    <style>
      .highlight-line-err {
        color: red !important;
        display: inline-block;
        position:relative;
        font-weight: bold;
        text-decoration: underline;
      }

      .highlight-line-gutter{
        	background: red;
          width: 5px !important;
          margin-left: 3px;
      }

      #monaco_editor {
        height: 95%;
      }

      .gutter {
        background-color: #eee;
        background-repeat: no-repeat;
        background-position: 50%;
      }

      .gutter.gutter-vertical {
        background-image: url("data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAB4AAAAFAQMAAABo7865AAAABlBMVEVHcEzMzMzyAv2sAAAAAXRSTlMAQObYZgAAABBJREFUeF5jOAMEEAIEEFwAn3kMwcB6I2AAAAAASUVORK5CYII=");
        cursor: row-resize;
      }

      .gutter.gutter-horizontal {
        background-image: url("data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAUAAAAeCAYAAADkftS9AAAAIklEQVQoU2M4c+bMfxAGAgYYmwGrIIiDjrELjpo5aiZeMwF+yNnOs5KSvgAAAABJRU5ErkJggg==");
        cursor: col-resize;
      }
    </style>
  </head>

  <body>
    <div id="yew_app"></div>
  </body>
</html>
